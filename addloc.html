<!DOCTYPE html>
<html>
    <head>
        <title>Add Location</title>
        
        <!-- Import Tailwind CSS output file -->
        <link href="./src/output.css" rel="stylesheet">
        
        <!-- Import Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800&display=swap" rel="stylesheet">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Hind:wght@300;400;500;600;700&display=swap" rel="stylesheet">
            
        <script type="module">
            import { addLocation } from "./js/firestore.js";

            document.getElementById("submit_form").addEventListener("click", handleFormSubmit);

            function handleFormSubmit() {
                const urlParams = new URLSearchParams(window.location.search);
                var latitude = urlParams.get('lat');
                var longitude = urlParams.get('lng');
                var partner = document.getElementById("partner").value;
                var partnerContactPerson = document.getElementById("partner_contact-person").value;
                var organization = document.getElementById("organization").value;
                var natureOfActivity = document.getElementById("nature_of_act").value;
                var datesOfPartnership = document.getElementById("dates_of_partnership").value;
                var ateneoOffice = document.getElementById("ateneo_office").value;
                var ateneoContactPerson = document.getElementById("ateneo_contact-person").value;
                var ateneoContactEmail = document.getElementById("ateneo_contact-email").value;
                
                // Parse the date input as a whole string
                var dateParts = datesOfPartnership.split("-");
                var year = dateParts[0];
                var month = dateParts[1];
                var day = dateParts[2];
                var parsedDatesOfPartnership = year + "-" + month + "-" + day;

                addLocation(
                    partner, 
                    natureOfActivity,
                    ateneoContactPerson,
                    ateneoContactEmail,
                    ateneoOffice,
                    organization,
                    partnerContactPerson,
                    parsedDatesOfPartnership,
                    latitude,
                    longitude
                );
                
                document.getElementById("partner").value = "";
                document.getElementById("partner_contact-person").value = "";
                document.getElementById("organization").value = "";
                document.getElementById("nature_of_act").value = "";
                document.getElementById("dates_of_partnership").value = "";
                document.getElementById("ateneo_office").value = "";
                document.getElementById("ateneo_contact-person").value = "";
                document.getElementById("ateneo_contact-email").value = "";
                
                // Display a success message
                alert("Form submitted successfully!");
            }
        </script>
    </head>
    
    <body>
        <div class="p-8 bg-customLightGray w-1/2"> 
            <h1 class="font-montserrat text-3xl font-bold text-darkbg mb-8">Add Activity</h1>
            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="partner">Partner</label>
                <input type="text" id="partner" name="partner" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">
            </div>
        
            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="partner_contact-person">Contact Person of Partner</label>
                <input type="text" id="partner_contact-person" name="partner_contact-person" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">    
            </div>
                
            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="organization">Organization / Unit</label>
                <input type="text" id="organization" name="organization" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">    
            </div>
                
            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="nature_of_act">Nature of Activity</label>
                <input type="text" id="nature_of_act" name="nature_of_act" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder=""> 
            </div>
                
            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="dates_of_partnership">Dates of Partnership</label>
                <input type="date" id="dates_of_partnership" name="dates_of_partnership" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">    
            </div>
                
            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="ateneo_office">Ateneo Office Oversight</label>
                <input type="text" id="ateneo_office" name="ateneo_office" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">    
            </div>
                
            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="ateneo_contact-person">Ateneo Contact Person</label>
                <input type="text" id="ateneo_contact-person" name="ateneo_contact-person" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">    
            </div>
                
            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="ateneo_contact-email">Email</label>
                <input type="email" id="ateneo_contact-email" name="ateneo_contact-email" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">    
            </div>
    
            <!-- Buttons -->
            <span class="button_div">
                <!-- Clears all contents of the form -->
                <button class="w-full py-4 text-center font-montserrat text-2xl bg-lightbg text-white font-bold rounded-lg" type="submit" id="submit_form" name="submit_form">Add Activity</button>   
                <button class="w-full py-4 text-center font-montserrat text-2xl text-red-700 font-bold border border-red-700 rounded-lg mt-4">Clear</button>
                <!-- Submits contents of the form -->                                               
            </span>

        </div>

    </body>  
</html>