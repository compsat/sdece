<!DOCTYPE html>
<html>
    <head>
        <title>Add Location</title>
        
        <!-- Import Tailwind CSS output file -->
        <link href="./src/output.css" rel="stylesheet">
        
        <!-- Import Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800&display=swap" rel="stylesheet">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Hind:wght@300;400;500;600;700&display=swap" rel="stylesheet">
            
        <script type="module">
            //import { addLocation } from "./js/firestore.js";
            import { addEntry, SDECE_RULES_TEST, setCollection, validateData } from "/firestore_UNIV.js";

            setCollection("sdece-official-TEST");

            document.addEventListener("DOMContentLoaded", function() {
                document.getElementById("submit_form").addEventListener("click", handleFormSubmit_v2);
            });

            function handleFormSubmit_v2(){
                console.log("clicked");
                var collatedInput = {};

                for(let i = 0; i < SDECE_RULES_TEST[2].length; i++){
                    //SDECE_RULES_TEST[2] are just the field names of each document
                    console.log(SDECE_RULES_TEST[2][i]);
                    let q = document.getElementById(SDECE_RULES_TEST[2][i]).value;
                    collatedInput[SDECE_RULES_TEST[2][i]] = q;

                    // this is where data validation will happen
                    // add the if-else statements of edge cases here
                }

                console.log(collatedInput);
                // This actually works but it needs some data validation
                // uncomment at the db's risk

                const errors = validateData("sdece-official-TEST", collatedInput);

                if (errors > 0) {
                    displayErrors(errors);
                } else {
                    addEntry(collatedInput);
                }

                function displayErrors(errors) {
                    let errorDiv = document.getElementById('error_messages');

                    if (errorDiv) {
                        errorDiv.innerHTML = '';

                        if (errors.length > 0) {
                            for(let error of errors) {
                                let errorParagraph = document.createElement('p');
                                errorParagraph.textContent = error;
                                errorDiv.appendChild(errorParagraph);
                            }
                        }
                    } else {
                        console.error("Error HAHAHHAHAHA")
                    }
                }
            }
        </script>
    </head>
    
    <body>
        <div class="p-8 bg-customLightGray w-1/2"> 
            <h1 class="font-montserrat text-3xl font-bold text-darkbg mb-8">Add Activity</h1>
            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="activity_name">Name of Activity</label>
                <input type="text" id="activity_name" name="activity_name" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">
            </div>

            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="activity_date">Date of Activity</label>
                <input type="date" id="activity_date" name="activity_date" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">
            </div>

            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="activity_nature">Nature of Activity</label>
                <input type="text" id="activity_nature" name="activity_nature" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder=""> 
            </div>

            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="partner_contact_name">Partner</label>
                <input type="text" id="partner_contact_name" name="partner_contact_name" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">
            </div>
        
            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="partner_contact_number">Contact Person of Partner</label>
                <input type="text" id="partner_contact_number" name="partner_contact_number" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">    
            </div>

            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="partner_address">City of Partner</label>
                <input type="text" id="partner_address" name="partner_address" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">    
            </div>

            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="partner_coordinates">Coordinates of Partner</label>
                <input type="geopoint" id="partner_coordinates" name="partner_coordinates" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">    
            </div>

            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="partner_email">Email of Partner</label>
                <input type="text" id="partner_email" name="partner_email" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">    
            </div>

            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="partner_contact_number">Contact number of Partner</label>
                <input type="text" id="partner_contact_number" name="partner_number" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">    
            </div>

            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="additional_partnership">additional Partner</label>
                <input type="text" id="additional_partnership" name="additional_partnership" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">    
            </div>
                
            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="organization_unit">Organization / Unit</label>
                <input type="text" id="organization_unit" name="organization_unit" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">    
            </div>
                
            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="ADMU_office">Ateneo Office Oversight</label>
                <input type="text" id="ADMU_office" name="admu_office" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">    
            </div>
                
            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="ADMU_contact_name">Ateneo Contact Person</label>
                <input type="text" id="ADMU_contact_name" name="admu_contact" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">    
            </div>
                
            <div class="flex flex-row justify-between mb-6 items-center">
                <label class="form font-montserrat text-xl text-customGray" for="ADMU_email">Email</label>
                <input type="text" id="ADMU_email" name="admu_email" class="py-4 px-8 w-96 rounded border font-montserrat" placeholder="">    
            </div>

            <br>

            <br><br>

            <!-- Error Messages -->
            <div id="error_messages"></div>
    
            <br><br>
    
    
            <!-- Buttons -->
            <div>
                <!-- Submits contents of the form -->                                               
                <button class="confirm form" type="submit" id="submit_form" name="submit_form">Save</button>   
            </div>
            <br>
    
            <!-- Buttons -->
            <span class="button_div">
                <!-- Clears all contents of the form -->
                <button class="w-full py-4 text-center font-montserrat text-2xl bg-lightbg text-white font-bold rounded-lg" type="submit" id="submit_form" name="submit_form">Add Activity</button>   
                <button class="w-full py-4 text-center font-montserrat text-2xl text-red-700 font-bold border border-red-700 rounded-lg mt-4">Clear</button>
                <!-- Submits contents of the form -->                                               
            </span>

        </div>

    </body>  
</html>