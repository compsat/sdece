<!DOCTYPE html>
<html>
	<head>
		<title>Edit Location</title>

		<!-- Import Tailwind CSS output file -->
		<link href="../css/form.css" rel="stylesheet" />

		<!-- Import Fonts -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800&display=swap"
			rel="stylesheet"
		/>
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
			rel="stylesheet"
		/>
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Hind:wght@300;400;500;600;700&display=swap"
			rel="stylesheet"
		/>

		<script type="module">
			//import { addLocation } from "./js/firestore.js";
			import {
				addEntry,
				SDECE_RULES_TEST,
				setCollection,
			} from '/firestore_UNIV.js';

			setCollection('sdece-official-TEST');

			document
				.getElementById('submit_form')
				.addEventListener('click', handleFormSubmit_v2);

			function handleFormSubmit_v2() {
				console.log('clicked');
				var collatedInput = {};

				for (let i = 0; i < SDECE_RULES_TEST[2].length; i++) {
					//SDECE_RULES_TEST[2] are just the field names of each document
					console.log(SDECE_RULES_TEST[2][i]);
					let q = document.getElementById(
						SDECE_RULES_TEST[2][i]
					).value;
					collatedInput[SDECE_RULES_TEST[2][i]] = q;

					// this is where data validation will happen
					// add the if-else statements of edge cases here
				}

				console.log(collatedInput);
				// This actually works but it needs some data validation
				// uncomment at the db's risk
				addEntry(collatedInput);
			}
		</script>
	</head>
	<body>
		<form
			action=""
			id="addLocForm"
			class="form-container"
		>
			<div class="form-body">
				<!-- Header -->
				<div class="form-header">
					<h1
						class="form-heading"
					>
						Edit Activity
					</h1>

					<button id="close-btn">

					<svg
						xmlns="http://www.w3.org/2000/svg"
						fill="none"
						viewBox="0 0 24 24"
						stroke-width="1.5"
						class="form-icon"
					>
						<path
							stroke-linecap="round"
							stroke-linejoin="round"
							d="M6 18 18 6M6 6l12 12"
						/>
					</svg>
				</div>
					</button>

				<!-- General Information -->
				<div class="form-section">
					<div
						class="form-field"
					>
						<label
							class="form-label"
							for="activity_name"
							>Activity Name</label
						>
						<input
							type="text"
							id="activity_name"
							name="activity_name"
							class="form-input"
							placeholder=""
						/>
					</div>

					<div
						class="form-field"
					>
						<label
							class="form-label"
							for="activity_nature"
							>Nature of Activity</label
						>
						<input
							type="text"
							id="activity_nature"
							name="activity_nature"
							class="form-input"
							placeholder=""
						/>
					</div>

					<div class="form-field">
						<label
							class="form-label"
							for="activity_date"
							>Date of Partnership</label
						>

						<div
							style="
								display: flex;
								flex-direction: column;
								align-items: flex-start;
							"
							id="date-container"
						>
							<input
								type="date"
								id="activity_date"
								name="activity_date"
								class="form-input"
								placeholder=""
							/>
							<!--
							<a
								href=""
								id="addDate"
								style="
									font-size: 1rem;
									line-height: 1.5rem;
									font-family: 'Montserrat';
									color: var(--lightbg);
									text-decoration-line: underline;
									margin-top: 1rem;
								"
								>Add another date</a
							>-->
						</div>
					</div>
				</div>

				<!-- PARTNER INFORMATION -->
				<div class="form-section">
					<h2
						class="form-subheading"
					>
						PARTNER INFORMATION
					</h2>

					<div
						class="form-field"
					>
						<label
							class="form-label"
							for="partner_name"
							>Name of Host Partner</label
						>
						<input
							type="text"
							id="partner_name"
							name="partner_name"
							class="form-input"
							placeholder=""
						/>
					</div>

					<div
						class="form-field"
					>
						<label
							class="form-label"
							for="partner_address"
							>Address of Host Partner</label
						>
						<input
							type="text"
							id="partner_address"
							name="partner_address"
							class="form-input"
							placeholder=""
						/>
					</div>
					<div
						class="form-field"
					>
						<label
							class="form-label"
							for="partner_contact_name"
							>Name of Contact Person</label
						>
						<input
							type="text"
							id="partner_contact_name"
							name="partner_contact_name"
							class="form-input"
							placeholder=""
						/>
					</div>

					<div
						class="form-field"
					>
						<label
							class="form-label"
							for="partner_contact_number"
							>Number of Contact Person
						</label>
						<input
							type="text"
							id="partner_contact_number"
							name="partner_contact_number"
							class="form-input"
							placeholder=""
						/>
					</div>
					<div
						class="form-field"
					>
						<label
							class="form-label"
							for="partner_email"
							>Email of Contact Person / Partner</label
						>
						<input
							type="email"
							id="partner_email"
							name="partner_email"
							class="form-input"
							placeholder=""
						/>
					</div>
				</div>

				<div class="form-section">
					<h2
						class="form-subheading"
					>
						ATENEO OFFICE OVERSIGHT
					</h2>

					<div
						class="form-field"
					>
						<label
							class="form-label"
							for="ADMU_office"
							>Name of Office</label
						>
						<input
							type="text"
							id="ADMU_office"
							name="ADMU_office"
							class="form-input"
							placeholder=""
						/>
					</div>
					<div
						class="form-field"
					>
						<label
							class="form-label"
							for="ADMU_contact_name"
							>Name of Ateneo Contact Person</label
						>
						<input
							type="text"
							id="ADMU_contact_name"
							name="ADMU_contact_name"
							class="form-input"
							placeholder=""
						/>
					</div>

					<div
						class="form-field"
					>
						<label
							class="form-label"
							for="ADMU_email"
							>Email of Ateneo Contact Person</label
						>
						<input
							type="email"
							id="ADMU_email"
							name="ADMU_email"
							class="form-input"
							placeholder=""
						/>
					</div>
				</div>

				<!-- Buttons -->
				<div class="form-buttons-container">
					<!-- Clears all contents of the form -->
					<button
						class="form-button positive"
						type="submit"
						id="submit_form"
						name="submit_form"
					>
						Save
					</button>
					<button
						class="form-button negative" id="deleteActivityButton"
					>
						Delete
					</button>
				</div>
			</div>
		</form>

		<script>
			document
				.getElementById('addLocForm')
				.addEventListener('submit', function (event) {
					event.preventDefault(); // Prevent the default form submission

					// Simulate successful submission (replace with actual form submission code)
					// Example: Submit form data via AJAX or fetch API

					// Assuming form submission is successful
					// Notify parent window (where the iframe is embedded)
					window.parent.postMessage(
						{ type: 'addlocFormSuccess' },
						'*'
					);
				});

			document
				.getElementById('addDate')
				.addEventListener('click', function (event) {
					event.preventDefault();
					var dateContainer =
						document.getElementById('date-container');
					var newDateInput = document.createElement('input');
					newDateInput.type = 'date';
					newDateInput.name = 'activity_date';
					newDateInput.className = 'form-input';
					newDateInput.style.marginTop = '1.5rem';
					dateContainer.insertBefore(newDateInput, this);
				});

			document
				.getElementById('close-btn')
				.addEventListener('click', function (event) {
					event.preventDefault();
					console.log(
						'The user has closed the Edit Activity modal.'
					);
					window.parent.postMessage('closeEditModal', '*');
				});
		</script>
	</body>
</html>
