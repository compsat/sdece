<!DOCTYPE html>
<html>
    <head>
        <title>Add Location</title>
        <link rel="stylesheet" href="./css/form.css">
        <link rel="stylesheet" href="./css/main.css">
            
        <script type="module">
            //import { addLocation } from "./js/firestore.js";
            import { addEntry, BUKLOD_RULES_TEST, setCollection } from "/firestore_UNIV.js";
            setCollection("buklod-official-TEST");
            document.getElementById("submit_form").addEventListener("click", handleFormSubmit_v2);

            function handleFormSubmit_v2(){
                console.log("clicked");
                var collatedInput = {};

                for(let i = 0; i < BUKLOD_RULES_TEST[2].length; i++){
                    //BUKLOD_RULES_TEST[2] are just the field names of each document
                    console.log(BUKLOD_RULES_TEST[2][i]);
                    let q = document.getElementById(BUKLOD_RULES_TEST[2][i]).value;
                    collatedInput[BUKLOD_RULES_TEST[2][i]] = q;

                    // this is where data validation will happen
                    // add the if-else statements of edge cases here
                }

                console.log(collatedInput);
                // This actually works but it needs some data validation
                // uncomment at the db's risk
                addEntry(collatedInput);
            }
        </script>
    </head>
    
    <body>
      <!-- Modal Header: includes title and address -->
      <div class="formModalHeader">
        <button type="button" class="closeForm" id="close-btn"></button>
        <h1 class="formHeader">Add Household</h1>
      </div>
      <!-- Modal Content: everything else -->
      <div class="formModalContent">
        <h2 class="subHeader">HOUSEHOLD INFORMATION</h2>
        <br>
        <!-- Form Proper -->
        <div class="inputContainer">
            <label class="form" for="household_name">Household Name</label>
            <input type="text" id="household_name" name="household_name" class="attribs">
        </div>
        <br>
        <div class="inputContainer">
            <label class="form" for="address">Address</label>
            <input type="text" id="address" name="address" class="attribs">    
        </div>
        <br>
        <div class="inputContainer">
            <label class="form" for="contact_number">Contact Number</label>
            <input type="text" id="contact_number" name="contact_number" class="attribs">    
        </div>
        <br>
        <div class="inputContainer">
            <label class="form" for="residency_status">Residency Status</label>
            <input type="text" id="residency_status" name="residency_status" class="attribs"> 
        </div>
        <br>
        <div class="inputContainer" style="justify-content: flex-start;">
            <label class="form" for="HOA/NOA">Part of HOA / NOA</label>
            <input type="checkbox" id="HOA/NOA" name="HOA/NOA" class="attribs" style="height: 30px;">
        </div>
        <br>
        <div class="inputContainer">
            <label class="form" for="materials_used_for_house">Materials Used for House</label>
            <input type="text" id="materials_used_for_house" name="materials_used_for_house" class="attribs"> 
        </div>
        <br>
        <div class="inputContainer">
            <label class="form" for="nearest_evacuation_area">Nearest Evacuation Area</label>
            <input type="text" id="nearest_evacuation_area" name="nearest_evacuation_area" class="attribs">    
        </div>
        <br>
        <h2 class="subHeader">RESIDENT INFORMATION</h2>
        <br>
        <div class="inputContainer">
            <label class="form" for="number_of_residents">Number of Residents</label>
            <input type="text" id="number_of_residents" name="number_of_residents" class="attribs">    
        </div>
        <br>
        <div class="inputContainer">
            <label class="form" for="number_of_minor_residents">Number of Minor Residents</label>
            <input type="text" id="number_of_minor_residents" name="number_of_minor_residents" class="attribs">
        </div>
        <br>
        <div class="inputContainer">
            <label class="form" for="number_of_senior_residents">Number of Senior Citizen Residents</label>
            <input type="text" id="number_of_senior_residents" name="number_of_senior_residents" class="attribs">
        </div>
        <br>
        <div class="inputContainer">
            <label class="form" for="number_of_pwd_residents">Number of PWD Residents</label>
            <input type="text" id="number_of_pwd_residents" name="number_of_pwd_residents" class="attribs">
        </div>
        <br>
        <div class="inputContainer">
            <label class="form" for="number_of_sick_residents">Number of Sick Residents</label>
            <input type="text" id="number_of_sick_residents" name="number_of_sick_residents" class="attribs">
        </div>
        <br>
        <div class="inputContainer">
            <label class="form" for="number_of_pregnant_residents">Number of Pregnant Residents</label>
            <input type="text" id="number_of_pregnant_residents" name="number_of_pregnant_residents" class="attribs">
        </div>
        <br>
        <h2 class="subHeader">RISK LEVELS</h2>
        <br>
        <div class="inputContainer">
            <label class="disasterForm" for="earthquake">Earthquake</label>
            <select name="earthquake_level" id="earthquake" class="attribs">
                <option value="" disabled selected hidden></option>
                <option value="high">HIGH</option>
                <option value="medium">MEDIUM</option>
                <option value="low">LOW</option>
            </select>
            <input type="text" id="earthquake" name="earthquake" class="attribs">
        </div>
        <br>
        <div class="inputContainer">
            <label class="disasterForm" for="fire">Fire</label>
            <select name="fire_level" id="fire" class="attribs">
                <option value="" disabled selected hidden></option>
                <option value="high">HIGH</option>
                <option value="medium">MEDIUM</option>
                <option value="low">LOW</option>
            </select>
            <input type="text" id="fire" name="fire" class="attribs">
        </div>
        <br>
        <div class="inputContainer">
            <label class="disasterForm" for="flood">Flood</label>
            <select name="flood_level" id="flood" class="attribs">
                <option value="" disabled selected hidden></option>
                <option value="high">HIGH</option>
                <option value="medium">MEDIUM</option>
                <option value="low">LOW</option>
            </select>
            <input type="email" id="flood" name="flood" class="attribs">
        </div>
        <br>
        <div class="inputContainer">
            <label class="disasterForm" for="landslide">Landslide</label>
            <select name="landslide_level" id="landslide" class="attribs">
                <option value="" disabled selected hidden></option>
                <option value="high">HIGH</option>
                <option value="medium">MEDIUM</option>
                <option value="low">LOW</option>
            </select>
            <input type="email" id="landslide" name="landslide" class="attribs">
        </div>
        <br>
        <div class="inputContainer">
            <label class="disasterForm" for="storm">Storm</label>
            <select name="storm_level" id="storm" class="attribs">
                <option value="" disabled selected hidden></option>
                <option value="high">HIGH</option>
                <option value="medium">MEDIUM</option>
                <option value="low">LOW</option>
            </select>
            <input type="email" id="storm" name="storm" class="attribs">
        </div>
        <!-- Save and Delete buttons -->
        <div class="buttonContainer">
          <div>
            <!-- Submits contents of the form -->                                               
            <button class="confirm form" type="submit" id="submit_form" name="submit_form">Save</button>   
          </div>
          <div>
            <!-- Clears all contents of the form -->
            <button class="clear form">Delete</button>
          </div>
        </div>
      </div>
      <!-- Modal Footer: empty space (for design) -->
      <div class="formModalFooter"></div>

      <script>
			function closeModal() {
				window.parent.postMessage('closeAddModal', '*');
			}

			document
				.getElementsByClassName('closeForm')[0]
				.addEventListener('click', function (event) {
					event.preventDefault();
					console.log(
						'The user has closed the Add Activity modal.'
					);
					closeModal();
				});


			function closeModal() {
				window.parent.postMessage('closeAddModal', '*');
			}

			document.getElementsByClassName('close-btn').addEventListener('click', function (event) {
					event.preventDefault();
					console.log(
						'The user has closed the Add Activity modal.'
					);
					closeModal();
				});
      </script>
    </body>  
</html>